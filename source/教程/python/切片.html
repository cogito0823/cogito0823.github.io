<html>
<head>
  <title>切片</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600753 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1799"/>
<h1>切片</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2019/9/3 2:54</i></td></tr>
</table>
</div>
<br/>

<div><span>
  <div style="--en-clipped-content:article">
<div><br/></div><div style="font-size: 16px; display:block; min-width: 100%; position: relative;"> <div style="font:14px/20px &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;text-size-adjust:100%;background:rgb(255, 255, 255);color:rgb(68, 68, 68);"><div style="font-family:&quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:14px;line-height:20px;color:rgb(102, 102, 102);background-color:rgb(255, 255, 255);"><div><div style="box-sizing:border-box;"><div style="list-style:none;"><div style="box-sizing:border-box;"><div><div><div><div><p style="margin:0px 0px 15px;">取一个list或tuple的部分元素是非常常见的操作。比如，一个list如下：</p>
<pre style="margin:0px 0px 15px;margin-top:15px;padding:10px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;"><code style="white-space:pre-wrap;"><span style="color:rgb(153, 0, 115);">&gt;&gt;&gt; </span>L = [<span style="color:rgb(221, 17, 68);">'Michael'</span>, <span style="color:rgb(221, 17, 68);">'Sarah'</span>, <span style="color:rgb(221, 17, 68);">'Tracy'</span>, <span style="color:rgb(221, 17, 68);">'Bob'</span>, <span style="color:rgb(221, 17, 68);">'Jack'</span>]
</code></pre>
<p style="margin:0px 0px 15px;margin-top:15px;">取前3个元素，应该怎么做？</p>
<p style="margin:0px 0px 15px;margin-top:15px;">笨办法：</p>
<pre style="margin:0px 0px 15px;margin-top:15px;padding:10px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;"><code style="white-space:pre-wrap;">&gt;&gt;&gt; <span>[L[0]</span>, <span style="color:rgb(0, 0, 128);font-weight:normal;">L</span><span>[1]</span>, <span style="color:rgb(0, 0, 128);font-weight:normal;">L</span><span>[2]</span>]
<span>['Michael', 'Sarah', 'Tracy']</span>
</code></pre>
<p style="margin:0px 0px 15px;margin-top:15px;">之所以是笨办法是因为扩展一下，取前N个元素就没辙了。</p>
<p style="margin:0px 0px 15px;margin-top:15px;">取前N个元素，也就是索引为0-(N-1)的元素，可以用循环：</p>
<pre style="margin:0px 0px 15px;margin-top:15px;padding:10px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;"><code style="white-space:pre-wrap;"><span style="color:rgb(153, 0, 115);">&gt;&gt;&gt; </span>r = []
<span style="color:rgb(153, 0, 115);">&gt;&gt;&gt; </span>n = <span style="color:rgb(0, 153, 153);">3</span>
<span style="color:rgb(153, 0, 115);">&gt;&gt;&gt; </span><span style="color:rgb(51, 51, 51);font-weight:bold;">for</span> i <span style="color:rgb(51, 51, 51);font-weight:bold;">in</span> range(n):
<span style="color:rgb(153, 0, 115);">... </span>    r.append(L[i])
<span style="color:rgb(153, 0, 115);">... </span>
<span style="color:rgb(153, 0, 115);">&gt;&gt;&gt; </span>r
[<span style="color:rgb(221, 17, 68);">'Michael'</span>, <span style="color:rgb(221, 17, 68);">'Sarah'</span>, <span style="color:rgb(221, 17, 68);">'Tracy'</span>]
</code></pre>
<p style="margin:0px 0px 15px;margin-top:15px;">对这种经常取指定索引范围的操作，用循环十分繁琐，因此，Python提供了切片（Slice）操作符，能大大简化这种操作。</p>
<p style="margin:0px 0px 15px;margin-top:15px;">对应上面的问题，取前3个元素，用一行代码就可以完成切片：</p>
<pre style="margin:0px 0px 15px;margin-top:15px;padding:10px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;"><code style="white-space:pre-wrap;">&gt;&gt;&gt; <span style="color:rgb(0, 0, 128);font-weight:normal;">L</span><span>[0:3]</span>
<span>['Michael', 'Sarah', 'Tracy']</span>
</code></pre>
<p style="margin:0px 0px 15px;margin-top:15px;"><code style="font-size:12px;font-family:Consolas, monospace, serif;color:rgb(221, 0, 85);padding:0px 4px;border:1px solid rgb(221, 221, 221);border-radius:3px;background:rgb(250, 250, 250);white-space:normal;">L[0:3]</code>表示，从索引<code style="font-size:12px;font-family:Consolas, monospace, serif;color:rgb(221, 0, 85);padding:0px 4px;border:1px solid rgb(221, 221, 221);border-radius:3px;background:rgb(250, 250, 250);white-space:normal;">0</code>开始取，直到索引<code style="font-size:12px;font-family:Consolas, monospace, serif;color:rgb(221, 0, 85);padding:0px 4px;border:1px solid rgb(221, 221, 221);border-radius:3px;background:rgb(250, 250, 250);white-space:normal;">3</code>为止，但不包括索引<code style="font-size:12px;font-family:Consolas, monospace, serif;color:rgb(221, 0, 85);padding:0px 4px;border:1px solid rgb(221, 221, 221);border-radius:3px;background:rgb(250, 250, 250);white-space:normal;">3</code>。即索引<code style="font-size:12px;font-family:Consolas, monospace, serif;color:rgb(221, 0, 85);padding:0px 4px;border:1px solid rgb(221, 221, 221);border-radius:3px;background:rgb(250, 250, 250);white-space:normal;">0</code>，<code style="font-size:12px;font-family:Consolas, monospace, serif;color:rgb(221, 0, 85);padding:0px 4px;border:1px solid rgb(221, 221, 221);border-radius:3px;background:rgb(250, 250, 250);white-space:normal;">1</code>，<code style="font-size:12px;font-family:Consolas, monospace, serif;color:rgb(221, 0, 85);padding:0px 4px;border:1px solid rgb(221, 221, 221);border-radius:3px;background:rgb(250, 250, 250);white-space:normal;">2</code>，正好是3个元素。</p>
<p style="margin:0px 0px 15px;margin-top:15px;">如果第一个索引是<code style="font-size:12px;font-family:Consolas, monospace, serif;color:rgb(221, 0, 85);padding:0px 4px;border:1px solid rgb(221, 221, 221);border-radius:3px;background:rgb(250, 250, 250);white-space:normal;">0</code>，还可以省略：</p>
<pre style="margin:0px 0px 15px;margin-top:15px;padding:10px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;"><code style="white-space:pre-wrap;">&gt;&gt;&gt; <span style="color:rgb(0, 0, 128);font-weight:normal;">L</span><span>[:3]</span>
<span>['Michael', 'Sarah', 'Tracy']</span>
</code></pre>
<p style="margin:0px 0px 15px;margin-top:15px;">也可以从索引1开始，取出2个元素出来：</p>
<pre style="margin:0px 0px 15px;margin-top:15px;padding:10px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;"><code style="white-space:pre-wrap;">&gt;&gt;&gt; <span style="color:rgb(0, 0, 128);font-weight:normal;">L</span><span>[1:3]</span>
<span>['Sarah', 'Tracy']</span>
</code></pre>
<p style="margin:0px 0px 15px;margin-top:15px;">类似的，既然Python支持<code style="font-size:12px;font-family:Consolas, monospace, serif;color:rgb(221, 0, 85);padding:0px 4px;border:1px solid rgb(221, 221, 221);border-radius:3px;background:rgb(250, 250, 250);white-space:normal;">L[-1]</code>取倒数第一个元素，那么它同样支持倒数切片，试试：</p>
<pre style="margin:0px 0px 15px;margin-top:15px;padding:10px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;"><code style="white-space:pre-wrap;">&gt;&gt;&gt; <span style="color:rgb(0, 0, 128);font-weight:normal;">L</span><span>[-2:]</span>
<span>['Bob', 'Jack']</span>
&gt;&gt;&gt; <span style="color:rgb(0, 0, 128);font-weight:normal;">L</span><span>[-2:-1]</span>
<span>['Bob']</span>
</code></pre>
<p style="margin:0px 0px 15px;margin-top:15px;">记住倒数第一个元素的索引是<code style="font-size:12px;font-family:Consolas, monospace, serif;color:rgb(221, 0, 85);padding:0px 4px;border:1px solid rgb(221, 221, 221);border-radius:3px;background:rgb(250, 250, 250);white-space:normal;">-1</code>。</p>
<p style="margin:0px 0px 15px;margin-top:15px;">切片操作十分有用。我们先创建一个0-99的数列：</p>
<pre style="margin:0px 0px 15px;margin-top:15px;padding:10px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;"><code style="white-space:pre-wrap;"><span style="color:rgb(153, 0, 115);">&gt;&gt;&gt; </span>L = list(range(<span style="color:rgb(0, 153, 153);">100</span>))
<span style="color:rgb(153, 0, 115);">&gt;&gt;&gt; </span>L
[<span style="color:rgb(0, 153, 153);">0</span>, <span style="color:rgb(0, 153, 153);">1</span>, <span style="color:rgb(0, 153, 153);">2</span>, <span style="color:rgb(0, 153, 153);">3</span>, ..., <span style="color:rgb(0, 153, 153);">99</span>]
</code></pre>
<p style="margin:0px 0px 15px;margin-top:15px;">可以通过切片轻松取出某一段数列。比如前10个数：</p>
<pre style="margin:0px 0px 15px;margin-top:15px;padding:10px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;"><code style="white-space:pre-wrap;">&gt;&gt;&gt; <span style="color:rgb(0, 0, 128);font-weight:normal;">L</span><span>[:10]</span>
<span>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
</code></pre>
<p style="margin:0px 0px 15px;margin-top:15px;">后10个数：</p>
<pre style="margin:0px 0px 15px;margin-top:15px;padding:10px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;"><code style="white-space:pre-wrap;">&gt;&gt;&gt; <span style="color:rgb(0, 0, 128);font-weight:normal;">L</span><span>[-10:]</span>
<span>[90, 91, 92, 93, 94, 95, 96, 97, 98, 99]</span>
</code></pre>
<p style="margin:0px 0px 15px;margin-top:15px;">前11-20个数：</p>
<pre style="margin:0px 0px 15px;margin-top:15px;padding:10px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;"><code style="white-space:pre-wrap;">&gt;&gt;&gt; <span style="color:rgb(0, 0, 128);font-weight:normal;">L</span><span>[10:20]</span>
<span>[10, 11, 12, 13, 14, 15, 16, 17, 18, 19]</span>
</code></pre>
<p style="margin:0px 0px 15px;margin-top:15px;">前10个数，每两个取一个：</p>
<pre style="margin:0px 0px 15px;margin-top:15px;padding:10px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;"><code style="white-space:pre-wrap;">&gt;&gt;&gt; <span style="color:rgb(0, 0, 128);font-weight:normal;">L</span><span>[:10:2]</span>
<span>[0, 2, 4, 6, 8]</span>
</code></pre>
<p style="margin:0px 0px 15px;margin-top:15px;">所有数，每5个取一个：</p>
<pre style="margin:0px 0px 15px;margin-top:15px;padding:10px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;"><code style="white-space:pre-wrap;">&gt;&gt;&gt; <span style="color:rgb(0, 0, 128);font-weight:normal;">L</span><span>[::5]</span>
<span>[0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95]</span>
</code></pre>
<p style="margin:0px 0px 15px;margin-top:15px;">甚至什么都不写，只写<code style="font-size:12px;font-family:Consolas, monospace, serif;color:rgb(221, 0, 85);padding:0px 4px;border:1px solid rgb(221, 221, 221);border-radius:3px;background:rgb(250, 250, 250);white-space:normal;">[:]</code>就可以原样复制一个list：</p>
<pre style="margin:0px 0px 15px;margin-top:15px;padding:10px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;"><code style="white-space:pre-wrap;">&gt;&gt;&gt; <span style="color:rgb(0, 0, 128);font-weight:normal;">L</span><span>[:]</span>
<span>[0, 1, 2, 3, ..., 99]</span>
</code></pre>
<p style="margin:0px 0px 15px;margin-top:15px;">tuple也是一种list，唯一区别是tuple不可变。因此，tuple也可以用切片操作，只是操作的结果仍是tuple：</p>
<pre style="margin:0px 0px 15px;margin-top:15px;padding:10px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;"><code style="white-space:pre-wrap;">&gt;&gt;&gt; (0, 1, 2, 3, 4, 5)<span>[:3]</span>
(0, 1, 2)
</code></pre>
<p style="margin:0px 0px 15px;margin-top:15px;">字符串<code style="font-size:12px;font-family:Consolas, monospace, serif;color:rgb(221, 0, 85);padding:0px 4px;border:1px solid rgb(221, 221, 221);border-radius:3px;background:rgb(250, 250, 250);white-space:normal;">'xxx'</code>也可以看成是一种list，每个元素就是一个字符。因此，字符串也可以用切片操作，只是操作结果仍是字符串：</p>
<pre style="margin:0px 0px 15px;margin-top:15px;padding:10px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;"><code style="white-space:pre-wrap;"><span style="color:rgb(153, 0, 115);">&gt;&gt;&gt; </span><span style="color:rgb(221, 17, 68);">'ABCDEFG'</span>[:<span style="color:rgb(0, 153, 153);">3</span>]
<span style="color:rgb(221, 17, 68);">'ABC'</span>
<span style="color:rgb(153, 0, 115);">&gt;&gt;&gt; </span><span style="color:rgb(221, 17, 68);">'ABCDEFG'</span>[::<span style="color:rgb(0, 153, 153);">2</span>]
<span style="color:rgb(221, 17, 68);">'ACEG'</span>
</code></pre>
<p style="margin:0px 0px 15px;margin-top:15px;">在很多编程语言中，针对字符串提供了很多各种截取函数（例如，substring），其实目的就是对字符串切片。Python没有针对字符串的截取函数，只需要切片一个操作就可以完成，非常简单。</p>
<h3 style="margin:0px 0px 15px;font-family:&quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-weight:normal;color:rgb(68, 68, 68);text-transform:none;margin-top:25px;font-size:18px;line-height:24px;">练习</h3>
<p style="margin:0px 0px 15px;margin-top:15px;">利用切片操作，实现一个trim()函数，去除字符串首尾的空格，注意不要调用str的<code style="font-size:12px;font-family:Consolas, monospace, serif;color:rgb(221, 0, 85);padding:0px 4px;border:1px solid rgb(221, 221, 221);border-radius:3px;background:rgb(250, 250, 250);white-space:normal;">strip()</code>方法：</p>
<div style="margin-top:15px;margin-bottom:15px;"><pre style="margin:0px 0px 15px;padding:6px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;font-size:14px;margin-bottom:0px;border-bottom:none;border-bottom-left-radius:0px;border-bottom-right-radius:0px;"># -*- coding: utf-8 -*-
def trim(s):
</pre><pre style="margin:0px 0px 15px;margin-top:0;padding:6px;background:rgb(250, 250, 250);font:12px/18px Consolas, monospace, serif;color:rgb(68, 68, 68);tab-size:4;overflow:auto;border:1px solid rgb(221, 221, 221);border-radius:3px;font-size:14px;border-top:0;border-top-left-radius:0;border-top-right-radius:0;"># 测试:
if trim('hello  ') != 'hello':
    print('测试失败!')
elif trim('  hello') != 'hello':
    print('测试失败!')
elif trim('  hello  ') != 'hello':
    print('测试失败!')
elif trim('  hello  world  ') != 'hello  world':
    print('测试失败!')
elif trim('') != '':
    print('测试失败!')
elif trim('    ') != '':
    print('测试失败!')
else:
    print('测试成功!')
</pre></div>
<h3 style="margin:0px 0px 15px;font-family:&quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-weight:normal;color:rgb(68, 68, 68);text-transform:none;margin-top:25px;font-size:18px;line-height:24px;">小结</h3>
<p style="margin:0px 0px 15px;margin-top:15px;">有了切片操作，很多地方循环就不再需要了。Python的切片非常灵活，一行代码就可以实现很多行循环才能完成的操作。</p>
<h3 style="margin:0px 0px 15px;font-family:&quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-weight:normal;color:rgb(68, 68, 68);text-transform:none;margin-top:25px;font-size:18px;line-height:24px;">参考源码</h3>
<p style="margin:0px 0px 15px;margin-top:15px;"><a href="https://github.com/michaelliao/learn-python3/blob/master/samples/advance/do_slice.py" style="background:transparent;color:rgb(5, 147, 211);text-decoration:none;cursor:pointer;" target="_blank">do_slice.py</a></p>
</div></div></div></div></div></div></div></div></div></div></div>
</div>
</span>
</div></body></html> 